<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title>Cloning an object using persistence</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      padding: 5px;
    }
    th {
      font-weight: bold;
    }
  </style>
</head>
<body>
  ## Cloning an object using persistence

  <div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53">This sample demonstrate an implementation of a clonable object through serialization. Sometimes, when you are writing your objects, you might need to supportÂ serialization. For example, a custom symbol or custom element needs to be saved with the map document and reloaded when the map document is opened. In most cases, you can achieve this functionality by implementing the IPersistVariant interface, which gives you an elegant solution. However, in some cases, IPersistVariant is not enough and your object must support IPersisStream, for example, if you need to support cloning through serialization. By temporarily saving your object to an ObjectStream, you can duplicate the object by creating an instance of your class and loading its properties from the temporary ObjectStream. To do so, use an ObjectCopy class (which uses ObjectStream internally). </div>  

```
Language:              C#
Subject:               SDK General
Organization:          Esri, http://www.esri.com
Date:                  10/17/2019
ArcObjects SDK:        10.8
Visual Studio:         2017, 2019
.NET Target Framework: 4.5
```

### Resources

* [ArcObjects .NET API Reference online](http://desktop.arcgis.com/en/arcobjects/latest/net/webframe.htm)  
* [Sample Data Download](../../releases)  
* [What's new](http://desktop.arcgis.com/en/arcobjects/latest/net/webframe.htm#91cabc68-2271-400a-8ff9-c7fb25108546.htm)  
* [Download the ArcObjects SDK for .Net from MyEsri.com](https://my.esri.com/)  

### Usage
1. Start Visual Studio and open the solution.  
1. Build the PeristStreamHelper.csproj, ClonableObj.csproj, and TestApp.csproj projects.  
1. Make sure the TestApp.csproj project is set as the startup project (in the Solution Explorer, right-click the project and select Set as StartUp Project).  
1. Press F5 to run the test application. A console window appears listing the flow of the test application (note the different messages reporting the state of the original and  cloned objects).  
1. When done, press any key to close the application.  

#### See Also  
[Implement IPersistStream in a .NET class](http://desktop.arcgis.com/search/?q=Implement%20IPersistStream%20in%20a%20.NET%20class&p=0&language=en&product=arcobjects-sdk-dotnet&version=&n=15&collection=help)  
[Implementing persistence](http://desktop.arcgis.com/search/?q=Implementing%20persistence&p=0&language=en&product=arcobjects-sdk-dotnet&version=&n=15&collection=help)  
[Implementing cloning](http://desktop.arcgis.com/search/?q=Implementing%20cloning&p=0&language=en&product=arcobjects-sdk-dotnet&version=&n=15&collection=help)  
[Sample: Triangle graphic element](../../../Net/GraphicsPipeline/TriangleElement)  
[Sample: Clonable object](../../../Net/SDK_General/ClonableObject)  

---------------------------------

#### Licensing  
<table><tr><th> Development licensing </th><th> Deployment licensing </th></tr>
<tr><td> Engine Developer Kit </td><td> Engine </td></tr>  
<tr><td> ArcGIS Desktop Basic </td><td> ArcGIS Desktop Basic </td></tr>  
<tr><td> ArcGIS Desktop Standard </td><td> ArcGIS Desktop Standard </td></tr>  
<tr><td> ArcGIS Desktop Advanced </td><td> ArcGIS Desktop Advanced </td></tr>  
</table>
</body>
</html>